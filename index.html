<!DOCTYPE html>
<html>
<head>

    <title>Estudio de la síntesis de voz mediante técnicas de aprendizaje profundo para la creación de voces sanas y patológicas</title>
    <style>
        /* Establecemos la imagen de fondo para el contenedor del título */
        .titulo-container {
            background-image: url(Imagenes/Fondo.jpeg);;
            background-size: cover;
            background-position: center;
            /* Establecemos el tamaño del contenedor y la altura mínima para asegurar que la imagen de fondo cubra todo el título */
            height: 180px;
            /* Establecemos el color y estilo del texto del título */
            color: white;
            text-align: center;
            font-size: 18px;
            /* Centramos el título verticalmente */
            display: flex;
            justify-content: center;
            align-items: center;
        }
      .logo1 {
            position: absolute;
            top: 115px; /* Distancia desde la parte superior */
            right: 50px; /* Distancia desde la derecha */
            width: 150px; /* Ancho del logotipo */
            height: 60px; /* Altura del logotipo */
        }
      .logo2 {
            position: absolute;
            top: 100px; /* Distancia desde la parte superior */
            left: 50px; /* Distancia desde la derecha */
            width: 150px; /* Ancho del logotipo */
            height: 80px; /* Altura del logotipo */
        }
    </style>
</head>
<body>
    <!-- Colocamos el título dentro del contenedor con la imagen de fondo -->
    <div class="titulo-container">
        <h1>Estudio de la síntesis de voz mediante técnicas de aprendizaje profundo para la creación de voces sanas y patológicas</h1>
    </div>
    <img src="Imagenes/Vivolab.png" alt="Imagen de Vivolab" class="logo1">
    <img src="Imagenes/Unizar.png" alt="Imagen de Unizar" class="logo2">
</body>

 <body>
  <center>
  <p><strong> Autor</strong>: Santiago Rubio Felipo.      <strong> Directores</strong> : Eduardo Lleida Solano,  Dayana Ribas González. </p>
  <span class="entry-meta"><time itemprop="datePublished" datetime="2023-08-28"><em>Agosto 28, 2023</em></time></span>
   </center>
<!--
<H2> INTRODUCCIÓN </H2>
<p>Hasta la obtención de una conexión segura mediante HTTPS, el servidor proporcionado por la Universidad funciona con el protocolo HTTP, lo que significa que la información se envía sin estar encriptada. Como resultado, es posible que tu navegador interprete este envío de datos como no seguro. Para solucionar este problema y permitir el acceso a la encuesta, te recomendamos configurar algunos parámetros para habilitar la conexión segura. Sin embargo, es importante destacar que esta encuesta no solicita ningún dato personal, por lo que te pedimos que no introduzcas ninguna información que no esté relacionada con las preguntas realizadas.
Recuerda que la seguridad y privacidad de tus datos son fundamentales, y en esta encuesta, no se te solicitará información personal. Si tienes alguna duda o inquietud, no dudes en contactarnos por correo 809622@unizar.es para brindarte la asistencia necesaria. Gracias por participar en la encuesta. Para configurar los parámetros necesarios para hacer la encuesta en Google tendrá que seguir los siquientes pasos:</p> 
	<ul>
	<li> En la parte superior de la pantalla donde la dirección URL aparece un candado cerrado. ¡Pulselo! </li>
	<center><img src="Imagenes/Pasos_Encuesta.png" alt="Imagen de Unizar"></center>
	<li> Al pulsar le habrá salido un desplegable donde tienes que pulsar al botón <strong> Configuración de sitios </strong> </li>
	<center><img src="Imagenes/Paso2_Encuesta.png" width=200px height=150px alt="Imagen de Unizar"></center>
	<li> En esa página busca "Contenido no seguro" y dale a "Permitir". Esta configuración solo afectará a este sitio web y al acabar la encuesta lo puedes volver a definir como estaba inicialmente.</li>
	<center><img src="Imagenes/Paso3_Encuesta.png" width=400px height=300px alt="Imagen de Unizar"></center>
	</ul>

<p>Disculpe las molestias. Estamos a esperas de que nos ofrezcan una conexión https para evitar esto.</p>
<H6><em>* Esta página aparece como conexión no segura debido a que los datos de la encuesta son recogidos en el servidor http://dihana.cps.unizar.es/ con conexión http que Google considera como no segura. Aunque aparezca como conexión no segura en esta encuesta no se le pedirá nigún dato personal y sólo se recogerán las preguntas hechas. Sus respuestas serán alamacenadas dentro del servidor Dihana de la Universidad de Zaragoza y no serán usados para nigún fin comercial. </em></H6>
 </body>
 <body>

 </body>
 <body>
  <h2>Modelo Propuesto</h2>
  <p>El modelo usado se trata de VITS.</p>
<center> <img src="Imagenes/VITS.png" alt="Modelo VITS"> </center>
-->
<h2>Introducción</h2>
<p>Esta encuesta tributa al Trabajo Fin de Grado (TFG):"Estudio de la síntesis de voz mediante técnicas de aprendizaje profundo para la creación de voces sanas y patológicas". Esta encuesta nos ayudará a evaluar la calidad y similitud de las voces generadas de personas sanas y con alguna patología de la voz. <!-- Los sistemas de síntesis de voz o sistemas TTS (<em>"Text to Speech"</em>) tienen como objetivo generar voces naturales e inteligibles a través de texto. Este trabajo se enfoca en el uso de estos sistemas de síntesis de voz en aplicaciones personalizadas y especializadas como la clonación de voces sanas o patológicas--></p>
<center><H3><stong>¡Muchas Gracias por su colaboración!</stong></H3></center>
<h2>Instrucciones para realizar la encuesta</h2>
	<H5>El tiempo requerido para hacer toda la encuesta será entre 10 y 15 minutos.</H5>
		<ul>
  		<li> Realizar esta encuesta en un lugar tranquilo y poco ruidoso. </li>
		<li> Realizarla en el ordenador. </li>
		<li> Usar cascos o aurículares. </li>
		<li> Realizar la encuesta en una página en incógnito</li>
		<li> Si te surgen dudas contáctame por 654736086 o 809622@unizar.es .</li>
	</ul>
	 <H4><center>Para evaluar la encuesta ir al subapartado de <strong>Encuesta</strong>.</H4>
	<H3><center><stong>¡Muchas Gracias por su colaboración!</stong></H3></center>
<p>Si se quieren escuchar más audios generados y valorarlo se pueden acceder al resto de secciones: "Librivox" que contiene solo un orador sano, "Albayzin" contiene 4 ordaores sanos, "Albayzin 216 speakers" con 216 speakers y "Thalento" con personas con algun tipo de patología.</p>	
 </body>
<h2>Antes de realizar la encuesta</h2>
<p>Antes de realizar la encuesta tendrá que aceptar los certificados de la conexión. El servidor usado para almacenar la base de datos tiene el certificado ssl de otra dirección de la universidad, por lo que la conexión no le saldrá como segura. Para dejar que su servidor le deje enviar la encuesta, tendrás que aceptarla como segura. Para aceptar la conexión entra a esta páginas web y acepta como dirección segura:</p>
<ul>
	<a href="https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin.php">Dirección 1</a>
	<a href="https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin216.php">Dirección 2</a>
<\ul>
<head>
    <title>Botones</title>
    <style>
        /* Estilo para los botones */
        .button-container {
            text-align: center; /* Centrar los botones en la misma línea */
        }

        .button {
            display: inline-block; /* Mostrar los botones en la misma línea */
            width: 120px;
            height: 50px;
            background-color: #ffcc80; /* Color de fondo naranja claro */
            color: black; /* Color de texto negro */
            border: 2px solid #fff; /* Borde blanco */
            margin: 10px; /* Espacio entre los botones */
            text-align: center;
            line-height: 50px; /* Centrar el texto verticalmente */
            cursor: pointer;
            font-size: 16px; /* Tamaño de texto */
            transition: background-color 0.2s, transform 0.2s; /* Transición de estilos al hacer clic */
        }

        .button.active {
            background-color: #ffa726; /* Color de fondo naranja oscuro cuando se presiona */
            font-size: 20px; /* Tamaño de texto más grande cuando se presiona */
            transform: scale(1.1); /* Escalar el botón cuando se presiona */
	    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Sombra al botón pulsado */
        }

        /* Estilo para el contenido desplegado */
        .content {
            display: none; /* Ocultar el contenido por defecto */
            background-color: #fff; /* Color de fondo blanco */
            color: black; /* Color de texto negro */
            padding: 10px;
            text-align: center;
        }

        /* Estilo para mostrar el contenido al hacer clic en un botón */
        .active .content {
            display: block; /* Mostrar el contenido cuando el botón está activo */
        }
    </style>
</head>
<body>
    <!-- Botones -->
    <div class="button-container">
	<div class="button" onclick="loadContent('encuesta.html')">Encuesta</div>
	<div class="button" onclick="loadContent('Thalento/index.html')">Thalento</div>
        <div class="button" onclick="loadContent('Albayzin/index.html')">Albayzin</div>
	<div class="button" onclick="loadBothContents()">Alb_216_Pers</div>
	<div class="button" onclick="loadContent('Librivox/index.html')">Librivox</div>
      <!-- <div class="button" onclick="loadContent('Thalento_sin_restricciones/index.html')">Thalento Lectura</div> -->
       <!--<div class="button" onclick="loadContent('Thalento/Audios/TVD-D-0001/TVD-D-0001_table.html')">Tabla</div>-->	
    </div>
    <div id="contenido"></div>
    
    <script>
	function loadBothContents() {
		cargar216Speakers()
    		loadContent('Albayzin/Audios/Tabla_216_speakers.html')
		cargar216Speakers()
		updateButtonStyle('Albayzin/Audios/Tabla_216_speakers.html');
    		
  	}
	function updateButtonStyle(url) {
	        var buttons = document.getElementsByClassName("button");
	        for (var i = 0; i < buttons.length; i++) {
	            buttons[i].classList.remove("active");
	        }
	        var button = document.querySelector(`[onclick="loadBothContents()"]`);
	        button.classList.add("active");
    	}
	document.addEventListener('DOMContentLoaded', function() {
        	var selectElement = document.getElementById("selectSpeakers216Albayzin");
        	if (selectElement) {
            		cargar216Speakers();
       		} else {
            		console.error("El elemento con el id 'selectSpeakers216Albayzin' no se encontró en el DOM.");
       		 }
	});
        function loadContent(url) {
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    var contenidoDiv = document.getElementById("contenido");
                    contenidoDiv.innerHTML = data;

                    // Cambiar el estilo del botón pulsado
                    var buttons = document.getElementsByClassName("button");
                    for (var i = 0; i < buttons.length; i++) {
                        buttons[i].classList.remove("active");
                    }
                    var button = document.querySelector(`[onclick="loadContent('${url}')"]`);
                    button.classList.add("active");		
                })
                .catch(error => {
                    console.error("Error:", error);
                });
        }
	function loadAudiosAlbayzin(value,speaker) {
	      var audioPlayerOriginales = document.getElementById("audioPlayerOriginales");
	      var audioPlayerSintetizados = document.getElementById("audioPlayerSintetizados");
	
	      // Si no se ha seleccionado ninguna opción, ocultar ambos audios
	      if (!value) {
	        audioPlayerOriginales.pause();
	        audioPlayerOriginales.src = "";
	        audioPlayerSintetizados.pause();
	        audioPlayerSintetizados.src = "";
	        return;
      	     }

	      // Construir las URLs de los audios Originales y Sintetizados
	      var audioSrcOriginales = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Originales/" +speaker+ "/" + value + ".wav";
	      var audioSrcSintetizados = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/" +speaker+ "/" + value + ".wav";
	
	      // Cargar y reproducir el audio Originales
	      audioPlayerOriginales.src = audioSrcOriginales;
	      audioPlayerOriginales.load();
	
	
	      // Cargar y reproducir el audio Sintetizados
	      audioPlayerSintetizados.src = audioSrcSintetizados;
	      audioPlayerSintetizados.load();
    }
    function guardarRespuestaAlbayzin() {
          var respuesta = {};
    
          // Obtener el valor seleccionado del select
          var select = document.getElementById("audioSelect");
          var audioSeleccionado = select.value;
    
          // Verificar si se ha seleccionado una opción en el select
          if (audioSeleccionado) {
            respuesta.audioSeleccionado = audioSeleccionado;
          }
    
          // Obtener el estado de los botones rectangulares y guardar si ha elegido el primero o el segundo
          var boton1 = document.getElementById("boton1");
          var boton2 = document.getElementById("boton2");
          if (boton1.checked) {
            respuesta.correcto = true;} else if (boton2.checked) {
            respuesta.correcto = false;
          }
    
          // Obtener las respuestas a las preguntas
          var respuestaSimilitud = document.querySelector(".button_circ.pregunta1.active");
          var respuestaCalidad = document.querySelector(".button_circ.pregunta2.active");

        var tabla = document.getElementById("tablaAlbayzin");
        var filas = tabla.getElementsByTagName("tr");
        
        for (var i = 2; i < filas.length; i++) {
              var celdas = filas[i].getElementsByTagName("td");

              // var audioSeleccionado = celdas[0].getElementsByTagName("select")[0].value;
              // var boton1 = celdas[2].getElementsByTagName("input")[0];
              // var boton2 = celdas[3].getElementsByTagName("input")[0];
              var calidad = -1;

              for (var j = 4; j < celdas.length; j++) {
                    var botones = celdas[j].getElementsByTagName("button");
                  console.log(botones)
                    for (var k = 0; k < botones.length; k++) {
                          if (botones[k].classList.contains("active")) {
                                calidad = j-4;
                                console.log(calidad)
                            break;
                          }
                    }
                    if (calidad !== -1) {
                          break;
                    }
              }
              if (i==2) {
                respuesta.respuestaSimilitud = calidad;
              }
              if (i==3) {
                // Hay que tener en cuenta que la primera esta dos veces
                respuesta.respuestaCalidad = calidad+1;
              }
             
        }
          // Convertir el objeto respuesta a formato JSON
          var respuestaJSON = JSON.stringify(respuesta);
	  respuestaJSON = respuestaJSON.trim();
          console.log(respuestaJSON);
        // Hacer el fetch la base de datos y el PHP
        fetch("https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin.php", {
    	    method: "POST",
	    headers: {
	        "Content-Type": "application/json"
	    },
	    body: respuestaJSON
	})
	.then(response => response.json())
	.then(data => {
	    console.log(data);
	    console.log("Datos enviados de manera correcta. Muchas gracias.")
	    // Aquí puedes mostrar un mensaje de agradecimiento o redireccionar a otra página
	})
	.catch(error => {
	    console.error("Error:", error);
	});
	alert("Respuestas enviadas correctamente.");

    }
    function enviarRespuestaAlbayzin(pregunta, respuesta) {
          // Lógica para guardar las respuestas en variables o en algún objeto, según necesites
          console.log("Pregunta:", pregunta, "Respuesta:", respuesta);
        
          // Resaltar el botón pulsado en la fila de respuesta correspondiente
          if (pregunta === 'pregunta1') {
            var buttons = document.querySelectorAll(".button_circ.pregunta1");
            buttons.forEach(button => button.classList.remove("active"));
            buttons[respuesta].classList.add("active");
          } else if (pregunta === 'pregunta2') {
            var buttons = document.querySelectorAll(".button_circ.pregunta2");
            buttons.forEach(button => button.classList.remove("active"));
            buttons[respuesta].classList.add("active");
          }
    }
    function activarBotonAlbayzin() {
          // Obtener el botón por su clase
              var boton = document.querySelector(".boton-rectangular");

              // Alternar el estado del botón (activado/desactivado)
              boton.checked = !boton.checked;
    }
   // A PARTIR DE AQUI EMPIEZA LAS FUNCIONES DE 216 SPEAKERS
  function loadAudiosAlbayzin216Speakers(value) {
	var audioPlayerOriginales = document.getElementById("audioPlayerOriginales");
	var audioPlayerSintetizados1 = document.getElementById("audioPlayerSintetizados1");
	var audioPlayerSintetizados2 = document.getElementById("audioPlayerSintetizados2");
        var audioPlayerSintetizados3 = document.getElementById("audioPlayerSintetizados3");
        var audioPlayerSintetizados4 = document.getElementById("audioPlayerSintetizados4");
        var audioPlayerSintetizados5 = document.getElementById("audioPlayerSintetizados5");
	// Si no se ha seleccionado ninguna opción, ocultar ambos audios
	if (!value) {
		audioPlayerOriginales.pause();
	        audioPlayerOriginales.src = "";
	        audioPlayerSintetizados1.pause();
	        audioPlayerSintetizados1.src = "";
            	audioPlayerSintetizados2.pause();
	        audioPlayerSintetizados2.src = "";
            	audioPlayerSintetizados3.pause();
	        audioPlayerSintetizados3.src = "";
            	audioPlayerSintetizados4.pause();
	        audioPlayerSintetizados4.src = "";
            	audioPlayerSintetizados5.pause();
	        audioPlayerSintetizados5.src = "";
	        return;
      	     }

      // Construir las URLs de los audios Originales y Sintetizados
      var audioSrcOriginales = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Originales/216Speaker/" + value + "_orginial.wav";
      var audioSrcSintetizados1 = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/216speakers/" +value+ "/" + value + "_fa000.wav";
      var audioSrcSintetizados2 = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/216speakers/" +value+ "/" + value + "_fa001.wav";
      var audioSrcSintetizados3 = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/216speakers/" +value+ "/" + value + "_fa002.wav";
      var audioSrcSintetizados4 = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/216speakers/" +value+ "/" + value + "_fa003.wav";
      var audioSrcSintetizados5 = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Sintetizados/216speakers/" +value+ "/" + value + "_fa004.wav";

      // Cargar y reproducir el audio Originales
      audioPlayerOriginales.src = audioSrcOriginales;
      audioPlayerOriginales.load();


      // Cargar y reproducir el audio Sintetizados
      audioPlayerSintetizados1.src = audioSrcSintetizados1;
      audioPlayerSintetizados1.load();
      audioPlayerSintetizados2.src = audioSrcSintetizados2;
      audioPlayerSintetizados2.load();
      audioPlayerSintetizados3.src = audioSrcSintetizados3;
      audioPlayerSintetizados3.load();
      audioPlayerSintetizados4.src = audioSrcSintetizados4;
      audioPlayerSintetizados4.load();
      audioPlayerSintetizados5.src = audioSrcSintetizados5;
      audioPlayerSintetizados5.load();
	}
     function cargar216Speakers() {
      // Cargar el JSON desde el archivo "data.json"
      fetch('https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Speakers_Albayzin.json')
        .then(response => response.json())
        .then(data => {
          // Obtén el elemento select por su id
          var select = document.getElementById("selectSpeakers216Albayzin");

          // Recorre el JSON y crea las opciones del select
          data.forEach(function(speaker) {
          var option = document.createElement("option");
            option.value = speaker.value;
            option.text = speaker.text;
            select.appendChild(option);
	});
        })
        .catch(error => {
          console.error("Error al cargar el JSON:", error);
        });
    }

	
	function guardarRespuestasAlbayzin216() {
	    var respuesta = {};
	
	    // Obtener el valor seleccionado del select
	    var select = document.getElementById("selectSpeakers216Albayzin");
	    var speakerSeleccionado = select.value;
	    console.log(speakerSeleccionado)
	    // Verificar si se ha seleccionado una opción en el select
	    if (!speakerSeleccionado) {
		alert("Debes seleccionar un speaker antes de enviar las respuestas.");
		return;
	    } else {
		respuesta.speakerSeleccionado = speakerSeleccionado;
	    }
	
	    // Recorrer las filas de la tabla y obtener los valores de los botones activos
	    var table = document.getElementById("tableAlbayzin216");
	    var rows = table.getElementsByTagName("tr");
	
	    for (var i = 0; i < rows.length; i++) {
		var cells = rows[i].getElementsByTagName("td");
	
		if (cells.length >= 7) { // Solo procesar filas con botones de respuesta
		    var pregunta = cells[0].innerText;
		    var calidad = -1; // Valor inicial en caso de que no haya ningún botón activo
	
		    // Encontrar el botón activo
		    for (var j = 1; j < cells.length; j++) {
			var botones = cells[j].getElementsByTagName("button");
			for (var k = 0; k < botones.length; k++) { 
			    if (botones[k].classList.contains("active")) {
				calidad = j - 1;
				break;
			    }
			}
	
			if (calidad !== -1) {
			    break;
			}
		    }
	
		    if (pregunta.includes("Similitud")) {
			respuesta.Similitud = calidad;
		    } else if (pregunta.includes("Calidad")) {
			respuesta.Calidad = calidad;
		    }
		}
	    }
	
	    // Obtener las anotaciones
	    var anotaciones = document.getElementById("anotaciones").value;
	    respuesta.anotaciones = anotaciones;
	
	    // Aquí puedes hacer lo que necesites con la lista de respuestas
	    console.log("Respuestas:", respuesta);
	fetch("https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin216.php", {
    	    method: "POST",
	    headers: {
	        "Content-Type": "application/json"
	    },
	    body: respuestaJSON
	})
	.then(response => response.json())
	.then(data => {
	    console.log(data);
	    console.log("Datos enviados de manera correcta. Muchas gracias.")
	    // Aquí puedes mostrar un mensaje de agradecimiento o redireccionar a otra página
	})
	.catch(error => {
	    console.error("Error:", error);
	});
	alert("Respuestas enviadas correctamente.");
  	}
	document.addEventListener('DOMContentLoaded', function() {
  		
	  var selectElement = document.getElementById("selectSpeakers216Albayzin");
	  if (selectElement) {
	    cargar216Speakers();
	  } else {
	    console.error("El elemento con el id 'selectSpeakers216Albayzin' no se encontró en el DOM.");
	  }
	});
	function loadAudiosLibrivox(value,speaker) {
	      var audioPlayerOriginalesLibrivox = document.getElementById("audioPlayerOriginalesLibrivox");
	      var audioPlayerSintetizadosLibrivox = document.getElementById("audioPlayerSintetizadosLibrivox");
	
	      // Si no se ha seleccionado ninguna opción, ocultar ambos audios
	      if (!value) {
	        audioPlayerOriginalesLibrivox.pause();
	        audioPlayerOriginalesLibrivox.src = "";
	        audioPlayerSintetizadosLibrivox.pause();
	        audioPlayerSintetizadosLibrivox.src = "";
	        return;
      	     }

	      // Construir las URLs de los audios Originales y Sintetizados
	      var audioSrcOriginales = "https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Originales/" +speaker+ "/" + value + ".wav";
	      var audioSrcSintetizados = "https://santirf01.github.io/TFG_TTS_page.io/Librivox/Audios/Sintetizados/audio_cap1_" +value+ ".wav";
	
	      // Cargar y reproducir el audio Originales
	      audioPlayerOriginalesLibrivox.src = audioSrcOriginales;
	      audioPlayerOriginalesLibrivox.load();
	
	
	      // Cargar y reproducir el audio Sintetizados
	      audioPlayerSintetizadosLibrivox.src = audioSrcSintetizados;
	      audioPlayerSintetizadosLibrivox.load();
    }

  function loadContent2(url) {
    // Cambiar el estilo del botón pulsado
    var buttons = document.getElementsByClassName("button");
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].classList.remove("active");
    }
    var button = document.querySelector(`[onclick="loadContent2('${url}')"]`);
    button.classList.add("active");
    // Agregar animación de carga mientras se carga el contenido
    var contenidoDiv = document.getElementById('contenido');
    contenidoDiv.innerHTML = '<div class="loader"></div>';
        var iframe = document.createElement('iframe');
        iframe.src = url;
        iframe.width = '100%';
        iframe.height = '400px';
        iframe.style.display = 'none';

        // Cuando el iframe esté cargado, ocultamos el loader y mostramos el iframe
        iframe.onload = function () {
            contenidoDiv.removeChild(document.querySelector('.loader'));
            iframe.style.display = 'block';
        };

        // Si hay algún contenido previo en el div con el ID "contenido", lo eliminamos
        while (contenidoDiv.firstChild) {
            contenidoDiv.removeChild(contenidoDiv.firstChild);
        }

        // Agregamos el iframe al div con el ID "contenido"
        contenidoDiv.appendChild(iframe);
  }
   function enviarRespuestaAlbayzinEncuesta(pregunta, respuesta) {
          // Lógica para guardar las respuestas en variables o en algún objeto, según necesites
          console.log("Pregunta:", pregunta, "Respuesta:", respuesta);
          var buttons = document.querySelectorAll(".button_circ."+pregunta);
	   buttons.forEach(button => button.classList.remove("active"));
           buttons[respuesta].classList.add("active");
    }
function guardarRespuestasAlbayzin216Encuesta(nombreTabla,speaker) {
	    var respuesta = {};
	
	    // Obtener el valor seleccionado del select
	    var tabla = document.getElementById(nombreTabla);
	    var primeraFila = tabla.rows[0];
	    console.log(primeraFila)
	    var select = primeraFila.cells[0].getElementsByTagName('h2')[0].innerText;
	    console.log(select)
	    var speakerSeleccionado = select;
	    console.log(speakerSeleccionado)
	    // Verificar si se ha seleccionado una opción en el select
	    if (!speakerSeleccionado) {
		alert("Debes seleccionar un speaker antes de enviar las respuestas.");
		return;
	    } else {
		respuesta.speakerSeleccionado = speakerSeleccionado;
	    }
	
	    // Recorrer las filas de la tabla y obtener los valores de los botones activos
	    var table = document.getElementById(nombreTabla);
	    var rows = table.getElementsByTagName("tr");
	
	    for (var i = 0; i < rows.length; i++) {
		var cells = rows[i].getElementsByTagName("td");
	
		if (cells.length >= 7) { // Solo procesar filas con botones de respuesta
		    var pregunta = cells[0].innerText;
		    var calidad = -1; // Valor inicial en caso de que no haya ningún botón activo
	
		    // Encontrar el botón activo
		    for (var j = 1; j < cells.length; j++) {
			var botones = cells[j].getElementsByTagName("button");
			for (var k = 0; k < botones.length; k++) { 
			    console.log(botones[k])
			    if (botones[k].classList.contains("active")) {
				calidad = j - 1;
				break;
			    }
			}
	
			if (calidad !== -1) {
			    break;
			}
		    }
	
		    if (pregunta.includes("Similitud")) {
			respuesta.Similitud = calidad;
		    } else if (pregunta.includes("Calidad")) {
			respuesta.Calidad = calidad;
		    }
		}
	    }
	
	    // Obtener las anotaciones
	    var anotaciones = document.getElementById("anotaciones_"+speaker).value;
	    respuesta.anotaciones = anotaciones;
		
	    // Aquí puedes hacer lo que necesites con la lista de respuestas
	    console.log("Respuestas:", respuesta);
	var respuestaJSON = JSON.stringify(respuesta);
	var certificado = 0;
    var errores = [];
    var sendingNotification = document.createElement("div");
    sendingNotification.classList.add("sending-notification");
	 sendingNotification.textContent = "Enviando datos...";
	document.body.appendChild(sendingNotification);
	
	sendingNotification.style.position = "fixed";
	sendingNotification.style.top = "10px";
	sendingNotification.style.left = "50%";
	sendingNotification.style.transform = "translateX(-50%)";
	sendingNotification.style.background = "yellow";
	sendingNotification.style.color = "black";
	sendingNotification.style.padding = "10px";
	sendingNotification.style.borderRadius = "5px";
	sendingNotification.style.zIndex = "1000";
	fetch("https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin216.php", {
    	    method: "POST",
	    headers: {
	        "Content-Type": "application/json"
	    },
	    body: respuestaJSON
	})
	.then(response => {
            if (!response.ok) {
                throw new Error("Error en la solicitud POST");
            }
            return response.json();
        })
        .then(data => {
            console.log(data);
        }).catch(error => {
            console.error("Error en la solicitud:", error);

            if (error.message.includes("Failed to fetch")) {
                errores.push("Certificado inválido");
		console.log("certificado inválido");
                certificado = 1;
            } else if (error.message.includes("Unexpected end of JSON input")) {
                // ... No hacer nada aquí ...
            } else {
                errores.push("Error en la solicitud");
            }
        });
console.log(certificado)
    setTimeout(function() {
        if (errores.length === 0) {
	    sendingNotification.style.display = "none";	
            var successNotification = document.createElement("div");
            successNotification.classList.add("success-notification");
            successNotification.textContent = "Respuestas enviadas correctamente.";
            document.body.appendChild(successNotification);

            successNotification.style.position = "fixed";
            successNotification.style.top = "10px";
            successNotification.style.left = "50%";
            successNotification.style.transform = "translateX(-50%)";
            successNotification.style.background = "green";
            successNotification.style.color = "white";
            successNotification.style.padding = "10px";
            successNotification.style.borderRadius = "5px";
            successNotification.style.zIndex = "1000";
            alert("Respuestas enviadas correctamente.");
	    setTimeout(function() {
    		successNotification.style.display = "none";
	    }, 3000);
        } else if (certificado === 1) {
	    sendingNotification.style.display = "none";	
            var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error con el certificado.";
            document.body.appendChild(errorNotification);

            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";

            alert("Se ha producido un error al recibir las respuestas por certificados. Para solucionarlo ponte en modo incógnito o intenta con otro navegador. Tambien puedes en el Candado(URL)/Configuración de sitios/Permitir Contenido No Seguro y recargar.");
        } else {
	    sendingNotification.style.display = "none";	
            var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error en las solicitudes. Revisa los datos y recarga la página.";
            document.body.appendChild(errorNotification);

            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";
	    alert("Se ha producido un error. Recarga una vez la página y si no desaparece informanos de tu error.")
        }
    }, 2000);
}  

    function loadContent(url) {

        fetch(url)
            .then(response => response.text())
            .then(data => {
                var contenidoDiv = document.getElementById("contenido");
                contenidoDiv.innerHTML = data;
                contenidoDiv.classList.add("contenido-cargado"); // Agregamos la clase al div de contenido
		if(url=='https://santirf01.github.io/TFG_TTS_page.io/Albayzin/Audios/Tabla_216_speakers.html'){
            		cargar216Speakers();
		}
            
            })
            .catch(error => {
                console.error("Error:", error);
            });
    }
function activarBotonRectangular(boton, grupo) {
    var botonesGrupo = document.querySelectorAll('.' + grupo + '.boton-rectangular');
    console.log(botonesGrupo)
    botonesGrupo.forEach(function(botonGrupo) {
        botonGrupo.classList.remove('active');
    });

    boton.classList.add('active');
}
function guardarRespuestaAlbayzin_Encuesta(nombreTabla,speaker) {
    var tabla = document.getElementById(nombreTabla);
    var filas = tabla.getElementsByTagName("tr");
    
    var jsonData = [];
    var respuestaPreguntaSimilitud = -1; 
    var respuestaPreguntaCalidad = -1;  

    for (var i = 3; i < filas.length; i += 3) {
        var json = {};
	// console.log(filas[i])
	// Consigo el nombre del audio
        var nombreAudio = filas[i].getElementsByTagName("p")[0].textContent;
	json.audioSeleccionado = nombreAudio;
	// Busco si el boton rectangular esta pulsado
	var botonRectangular1 = filas[i].querySelector(".boton-rectangular");
	var tieneTick1 = botonRectangular1.querySelector(".tick")!== null;;
	var botonRectangular2 = filas[i+1].querySelector(".boton-rectangular");
	var tieneTick2 = botonRectangular2.querySelector(".tick")!== null;;
	console.log(botonRectangular1)
	console.log(botonRectangular2)
        // var botonRectangular1 = filas[i].querySelector(".boton-rectangular:checked");
        // var botonRectangular2 = filas[i + 1].querySelector(".boton-rectangular:checked");
        if ( botonRectangular1.classList.contains("active")) {
	    console.log('botonRectangular1')
            // json.botonActivo = botonRectangular1.textContent.trim();
	    var audioElement = botonRectangular1.parentElement.previousElementSibling.querySelector("audio");
    	    if (audioElement) {
		console.log('botonRectangular2')
        	var audioSrc = audioElement.querySelector("source").getAttribute("src");
        	console.log("Audio src:", audioSrc);
		json.correcto = audioSrc.includes("Originales") ? 1 : 0;
    	    }
        } else if (botonRectangular2.classList.contains("active")) {
	     console.log('botonRectangular2')
            // json.botonActivo = botonRectangular2.textContent.trim();
    	    var audioElement = botonRectangular2.parentElement.previousElementSibling.querySelector("audio");
    	    if (audioElement) {
        	var audioSrc = audioElement.querySelector("source").getAttribute("src");
        	console.log("Audio src:", audioSrc);
		json.correcto = audioSrc.includes("Originales") ? 1 : 0;
    	   }
        }

        var respuestasPregunta1 = [];
        var respuestasPregunta2 = [];

        for (var j = 4; j < filas[i].cells.length; j++) {
	    // console.log(filas[i].cells[j])
	    // console.log(filas[i+1].cells[j-1])
	    var numPregunta = Math.floor(i / 3);
            var respuestaButton1 = filas[i].cells[j].querySelector(`.button_circ.pregunta1_000${numPregunta}_${speaker}.active`);
            var respuestaButton2 = filas[i + 1].cells[j - 1].querySelector(`.button_circ.pregunta2_000${numPregunta}_${speaker}.active`);
            // console.log(respuestaButton1)
            // console.log(respuestaButton2)   
	// var respuestaButton1 = filas[i].cells[j].querySelector(".button_circ.pregunta1.active");
            // var respuestaButton2 = filas[i + 1].cells[j-1].querySelector(".button_circ.pregunta2.active");

            if (respuestaButton1) {
		respuestaPreguntaSimilitud = j-4;
                // respuestaPreguntaSimilitud.push(respuestaButton1.textContent.trim());
		console.log(numPregunta)
		console.log("RESPUESTA Similitud")
		console.log(respuestaPreguntaSimilitud)
            }

            if (respuestaButton2) {
		respuestaPreguntaCalidad = j-4; 
		console.log(numPregunta)
		console.log("RESPUESTA Calidad")
		console.log(respuestaPreguntaCalidad)
                // respuestasPreguntaCalidad.push(respuestaButton2.textContent.trim());
            }
        }

        json.respuestaSimilitud = respuestaPreguntaSimilitud;
        json.respuestaCalidad  = respuestaPreguntaCalidad;

        jsonData.push(json);
    }
  
    // Aquí tienes el arreglo jsonData con los tres JSONs generados
    console.log(jsonData);

    var completadoContador = 0;
    var certificado = 0;
    var errores = [];
    var sendingNotification = document.createElement("div");
    sendingNotification.classList.add("sending-notification");
	 sendingNotification.textContent = "Enviando datos...";
	document.body.appendChild(sendingNotification);
	
	sendingNotification.style.position = "fixed";
	sendingNotification.style.top = "10px";
	sendingNotification.style.left = "50%";
	sendingNotification.style.transform = "translateX(-50%)";
	sendingNotification.style.background = "yellow";
	sendingNotification.style.color = "black";
	sendingNotification.style.padding = "10px";
	sendingNotification.style.borderRadius = "5px";
	sendingNotification.style.zIndex = "1000";
    jsonData.forEach(function(json) {
	    fetch("https://dihana.cps.unizar.es/encuestatts/guardar_datos_Albayzin.php", {
	        method: "POST",
	        headers: {
	            "Content-Type": "application/json"
	        },
	        body: JSON.stringify(json) // Convertir el arreglo de objetos JSON a cadena JSON
	    })
	    .then(response => {
            if (!response.ok) {
                throw new Error("Error en la solicitud POST");
            }
            return response.json();
        })
        .then(data => {
            console.log(data);
            completadoContador++;
        })
        .catch(error => {
            console.error("Error en la solicitud:", error);

            if (error.message.includes("Failed to fetch")) {
                errores.push("Certificado inválido");
		console.log("certificado inválido");
                certificado = 1;
            } else if (error.message.includes("Unexpected non-whitespace character after JSON")) {
                // ... No hacer nada aquí ...
            } else {
                errores.push("Error en la solicitud");
            }
        });
    });
console.log(certificado)
    setTimeout(function() {
        if (errores.length === 0) {
	    sendingNotification.style.display = "none";	
            var successNotification = document.createElement("div");
            successNotification.classList.add("success-notification");
            successNotification.textContent = "Respuestas enviadas correctamente en tres ocasiones.";
            document.body.appendChild(successNotification);

            successNotification.style.position = "fixed";
            successNotification.style.top = "10px";
            successNotification.style.left = "50%";
            successNotification.style.transform = "translateX(-50%)";
            successNotification.style.background = "green";
            successNotification.style.color = "white";
            successNotification.style.padding = "10px";
            successNotification.style.borderRadius = "5px";
            successNotification.style.zIndex = "1000";
            alert("Respuestas enviadas correctamente.");
	    setTimeout(function() {
    		successNotification.style.display = "none";
	    }, 3000);
        } else if (certificado === 1) {
	    sendingNotification.style.display = "none";	
            var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error con el certificado.";
            document.body.appendChild(errorNotification);

            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";

            alert("Se ha producido un error al recibir las respuestas por certificados. Para solucionarlo ponte en modo incógnito o intenta con otro navegador. Tambien puedes en el Candado(URL)/Configuración de sitios/Permitir Contenido No Seguro y recargar.");
        } else {
	    sendingNotification.style.display = "none";	
            var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error en las solicitudes. Revisa los datos y recarga la página.";
            document.body.appendChild(errorNotification);

            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";
	    alert("Se ha producido un error. Recarga una vez la página y si no desaparece informanos de tu error.")
        }
    }, jsonData.length * 1000);
}  
</script>
</body>
</html>
<!--
		 .catch(error => {
        console.error("Error en la solicitud:", error);

        // Verificar si el error contiene ciertas palabras clave
        if (error.message.includes("Unexpected non-whitespace character after JSON")) {
	     completadoContador++;
	    if (completadoContador === 3) {
		    console.log(data);
	    	    console.log("Datos enviados de manera correcta. Muchas gracias.");
	            var successNotification = document.createElement("div");
	            successNotification.classList.add("success-notification");
	            successNotification.textContent = "Respuestas enviadas correctamente en tres ocasiones.";
	            document.body.appendChild(successNotification);
	
	            // Puedes agregar estilos CSS para darle formato a la notificación de éxito
	            successNotification.style.position = "fixed";
	            successNotification.style.top = "10px";
	            successNotification.style.left = "50%";
	            successNotification.style.transform = "translateX(-50%)";
	            successNotification.style.background = "green";
	            successNotification.style.color = "white";
	            successNotification.style.padding = "10px";
	            successNotification.style.borderRadius = "5px";
	            successNotification.style.zIndex = "1000";
		    completadoContador = 0;
		    alert("Respuestas enviadas correctamente.");	
	        }
		
            // No mostrar la notificación en estos casos
        } else if (error.message.includes("net::ERR_CERT_COMMON_NAME_INVALID")){
            // Mostrar notificación de error encima del mensaje
            var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error al recibir las respuestas. Recarga la página";
            document.body.appendChild(errorNotification);

            // Puedes agregar estilos CSS para darle formato a la notificación
            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";
            
            alert("Se ha producido un error al recibir las respuestas por permisos. Para solucionarlo asegurate de estar en incóginito o intenta con otro navegador.");
        }else {
	    var errorNotification = document.createElement("div");
            errorNotification.classList.add("error-notification");
            errorNotification.textContent = "Se ha producido un error asegurate de haber realizado todo bien.";
            document.body.appendChild(errorNotification);

            // Puedes agregar estilos CSS para darle formato a la notificación
            errorNotification.style.position = "fixed";
            errorNotification.style.top = "10px";
            errorNotification.style.left = "50%";
            errorNotification.style.transform = "translateX(-50%)";
            errorNotification.style.background = "red";
            errorNotification.style.color = "white";
            errorNotification.style.padding = "10px";
            errorNotification.style.borderRadius = "5px";
            errorNotification.style.zIndex = "1000";
	}
    }).then(data => {
    completadoContador++;
    if (completadoContador === 3) {
	    console.log(data);
    	    console.log("Datos enviados de manera correcta. Muchas gracias.");
	    alert("Respuestas enviadas correctamente.");	
            var successNotification = document.createElement("div");
            successNotification.classList.add("success-notification");
            successNotification.textContent = "Respuestas enviadas correctamente en tres ocasiones.";
            document.body.appendChild(successNotification);

            // Puedes agregar estilos CSS para darle formato a la notificación de éxito
            successNotification.style.position = "fixed";
            successNotification.style.top = "10px";
            successNotification.style.left = "50%";
            successNotification.style.transform = "translateX(-50%)";
            successNotification.style.background = "green";
            successNotification.style.color = "white";
            successNotification.style.padding = "10px";
            successNotification.style.borderRadius = "5px";
            successNotification.style.zIndex = "1000";
	    completadoContador = 0;
        }

})

	-->
